<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRF App - Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            min-height: 100vh;
        }

        .header {
            background: #007AFF;
            color: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-name {
            font-weight: 600;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .welcome-section {
            background: linear-gradient(135deg, #5abaa3 0%, #26397f 100%);
            color: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .welcome-title {
            font-size: 28px;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
        }





        .actions-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .action-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: center;
            border-left: 4px solid #5abaa3;
        }

        .action-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(90, 186, 163, 0.2);
            border-left-color: #4a9a8a;
        }

        .action-icon {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .action-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .action-description {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .alert.error {
            background: #FFE5E5;
            color: #D32F2F;
            border: 1px solid #FFCDD2;
        }

        .alert.success {
            background: rgba(90, 186, 163, 0.1);
            color: #2E7D32;
            border: 1px solid #5abaa3;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #5abaa3;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .download-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .download-section h3 {
            color: #26397f;
            margin-bottom: 15px;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }





            .actions-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">CRF App</div>
            <div class="user-info">
                <span class="user-name" id="userName">Carregando...</span>
                <button class="logout-btn" onclick="logout()">Sair</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div id="alert" class="alert"></div>

        <div class="welcome-section">
            <h1 class="welcome-title">Bem-vindo ao CRF App</h1>
            <p class="welcome-subtitle">Sistema de FiscalizaÃ§Ã£o e Monitoramento</p>
        </div>



        <!-- SeÃ§Ã£o de Downloads Principais -->
        <div class="download-section">
            <h3>ğŸ“¥ Downloads de Dados</h3>
            
            <!-- Baixar Tudo -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarTudo()">
                    <div class="action-icon">ğŸš€</div>
                    <div class="action-title">Baixar Tudo</div>
                    <div class="action-description">Download completo de todos os dados</div>
                </div>
            </div>

            <!-- Listar Empresas (linha inteira) -->
            <div class="actions-row">
                <div class="action-card" onclick="window.location.href='/empresas'">
                    <div class="action-icon">ğŸ“‹</div>
                    <div class="action-title">Listar Empresas</div>
                    <div class="action-description">Visualizar empresas cadastradas</div>
                </div>
            </div>

            <!-- Baixar Empresas e Ver Empresas -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarEmpresas()">
                    <div class="action-icon">ğŸ“¥</div>
                    <div class="action-title">Baixar Empresas</div>
                    <div class="action-description">Baixar empresas do servidor</div>
                </div>
                <div class="action-card" onclick="visualizarEmpresasLocais()" style="background-color: #ff6b6b; color: white;">
                    <div class="action-icon">ğŸ‘ï¸</div>
                    <div class="action-title">Ver Empresas</div>
                    <div class="action-description">Visualizar dados locais</div>
                </div>
            </div>



            <!-- ConfiguraÃ§Ã£o do Termo -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarConfigTermo()">
                    <div class="action-icon">ğŸ“‹</div>
                    <div class="action-title">Baixar ConfiguraÃ§Ã£o</div>
                    <div class="action-description">ConfiguraÃ§Ã£o do termo</div>
                </div>
                <div class="action-card" onclick="visualizarConfigTermo()" style="background-color: #4ecdc4; color: white;">
                    <div class="action-icon">ğŸ“‹</div>
                    <div class="action-title">Ver ConfiguraÃ§Ã£o</div>
                    <div class="action-description">Visualizar configuraÃ§Ã£o</div>
                </div>
            </div>

            <!-- HistÃ³rico de RTS -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarRtsHistorico()">
                    <div class="action-icon">ğŸ‘¥</div>
                    <div class="action-title">Baixar RTS</div>
                    <div class="action-description">HistÃ³rico de RTS</div>
                </div>
                <div class="action-card" onclick="visualizarRtsHistorico()" style="background-color: #ffa726; color: white;">
                    <div class="action-icon">ğŸ‘¥</div>
                    <div class="action-title">Ver RTS</div>
                    <div class="action-description">Visualizar histÃ³rico RTS</div>
                </div>
            </div>

            <!-- Tipos de InspeÃ§Ã£o -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarTiposInspecao()">
                    <div class="action-icon">ğŸ”</div>
                    <div class="action-title">Baixar Tipos</div>
                    <div class="action-description">Tipos de inspeÃ§Ã£o</div>
                </div>
                <div class="action-card" onclick="visualizarTiposInspecao()" style="background-color: #9c27b0; color: white;">
                    <div class="action-icon">ğŸ”</div>
                    <div class="action-title">Ver Tipos</div>
                    <div class="action-description">Visualizar tipos</div>
                </div>
            </div>

            <!-- HistÃ³rico de InspeÃ§Ãµes -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarInspecoesHistorico()">
                    <div class="action-icon">ğŸ“Š</div>
                    <div class="action-title">Baixar InspeÃ§Ãµes</div>
                    <div class="action-description">HistÃ³rico de inspeÃ§Ãµes</div>
                </div>
                <div class="action-card" onclick="visualizarInspecoesHistorico()" style="background-color: #e91e63; color: white;">
                    <div class="action-icon">ğŸ“Š</div>
                    <div class="action-title">Ver InspeÃ§Ãµes</div>
                    <div class="action-description">Visualizar inspeÃ§Ãµes</div>
                </div>
            </div>

            <!-- Protocolos -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarProtocolos()">
                    <div class="action-icon">ğŸ“„</div>
                    <div class="action-title">Baixar Protocolos</div>
                    <div class="action-description">Protocolos disponÃ­veis</div>
                </div>
                <div class="action-card" onclick="visualizarProtocolos()" style="background-color: #795548; color: white;">
                    <div class="action-icon">ğŸ“„</div>
                    <div class="action-title">Ver Protocolos</div>
                    <div class="action-description">Visualizar protocolos</div>
                </div>
            </div>

            <!-- Afastamentos -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarAfastamentos()">
                    <div class="action-icon">ğŸ¥</div>
                    <div class="action-title">Baixar Afastamentos</div>
                    <div class="action-description">Dados de afastamentos</div>
                </div>
                <div class="action-card" onclick="visualizarAfastamentos()" style="background-color: #607d8b; color: white;">
                    <div class="action-icon">ğŸ¥</div>
                    <div class="action-title">Ver Afastamentos</div>
                    <div class="action-description">Visualizar afastamentos</div>
                </div>
            </div>

            <!-- DenÃºncias -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarDenuncias()">
                    <div class="action-icon">ğŸš¨</div>
                    <div class="action-title">Baixar DenÃºncias</div>
                    <div class="action-description">HistÃ³rico de denÃºncias</div>
                </div>
                <div class="action-card" onclick="visualizarDenuncias()" style="background-color: #f44336; color: white;">
                    <div class="action-icon">ğŸš¨</div>
                    <div class="action-title">Ver DenÃºncias</div>
                    <div class="action-description">Visualizar denÃºncias</div>
                </div>
            </div>

            <!-- Outros Profissionais -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarOutrosProfissionais()">
                    <div class="action-icon">ğŸ‘¨â€âš•ï¸</div>
                    <div class="action-title">Baixar Outros Profissionais</div>
                    <div class="action-description">Dados de outros profissionais</div>
                </div>
                <div class="action-card" onclick="visualizarOutrosProfissionais()" style="background-color: #2196f3; color: white;">
                    <div class="action-icon">ğŸ‘¨â€âš•ï¸</div>
                    <div class="action-title">Ver Outros Profissionais</div>
                    <div class="action-description">Visualizar profissionais</div>
                </div>
            </div>

            <!-- Outros VÃ­nculos -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarOutrosVinculos()">
                    <div class="action-icon">ğŸ”—</div>
                    <div class="action-title">Baixar Outros VÃ­nculos</div>
                    <div class="action-description">VÃ­nculos profissionais</div>
                </div>
                <div class="action-card" onclick="visualizarOutrosVinculos()" style="background-color: #ff9800; color: white;">
                    <div class="action-icon">ğŸ”—</div>
                    <div class="action-title">Ver Outros VÃ­nculos</div>
                    <div class="action-description">Visualizar vÃ­nculos</div>
                </div>
            </div>

            <!-- Processos Ã‰ticos -->
            <div class="actions-row">
                <div class="action-card" onclick="baixarProcessosEticos()">
                    <div class="action-icon">âš–ï¸</div>
                    <div class="action-title">Baixar Processos Ã‰ticos</div>
                    <div class="action-description">Processos Ã©ticos</div>
                </div>
                <div class="action-card" onclick="visualizarProcessosEticos()" style="background-color: #673ab7; color: white;">
                    <div class="action-icon">âš–ï¸</div>
                    <div class="action-title">Ver Processos Ã‰ticos</div>
                    <div class="action-description">Visualizar processos</div>
                </div>
            </div>
        </div>

        <!-- Ãrea de ConteÃºdo para VisualizaÃ§Ã£o -->
        <div id="content"></div>


    </div>

    <script>
        const alertDiv = document.getElementById('alert');
        const userNameElement = document.getElementById('userName');

        function showAlert(message, type) {
            alertDiv.textContent = message;
            alertDiv.className = `alert ${type}`;
            alertDiv.style.display = 'block';
        }

        function hideAlert() {
            alertDiv.style.display = 'none';
        }

        function logout() {
            localStorage.removeItem('isAuthenticated');
            localStorage.removeItem('user');
            window.location.href = '/';
        }



        // FunÃ§Ãµes de Download (usando APIs reais)
        function baixarTudo() {
            showAlert('ğŸš€ Iniciando download completo de todos os dados...', 'success');
            
            // Executar todos os downloads sequencialmente
            const downloads = [
                { name: 'ConfiguraÃ§Ã£o', func: baixarConfigTermo },
                { name: 'RTS', func: baixarRtsHistorico },
                { name: 'Tipos de InspeÃ§Ã£o', func: baixarTiposInspecao },
                { name: 'InspeÃ§Ãµes', func: baixarInspecoesHistorico },
                { name: 'Protocolos', func: baixarProtocolos },
                { name: 'Afastamentos', func: baixarAfastamentos },
                { name: 'DenÃºncias', func: baixarDenuncias },
                { name: 'Outros Profissionais', func: baixarOutrosProfissionais },
                { name: 'Outros VÃ­nculos', func: baixarOutrosVinculos },
                { name: 'Processos Ã‰ticos', func: baixarProcessosEticos }
            ];

            let completed = 0;
            let successCount = 0;
            let errorCount = 0;

            downloads.forEach((download, index) => {
                setTimeout(() => {
                    download.func().then(() => {
                        successCount++;
                        completed++;
                        if (completed === downloads.length) {
                            showAlert(`âœ… Download completo finalizado! ${successCount} sucessos, ${errorCount} erros`, 'success');
                        }
                    }).catch(() => {
                        errorCount++;
                        completed++;
                        if (completed === downloads.length) {
                            showAlert(`âš ï¸ Download completo finalizado! ${successCount} sucessos, ${errorCount} erros`, 'error');
                        }
                    });
                }, index * 1000); // Executar com 1 segundo de intervalo
            });
        }

        function baixarEmpresas() {
            showAlert('ğŸ“¥ Baixando empresas do servidor...', 'success');
            
            // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
            const user = localStorage.getItem('user');
            let iduser = '1'; // valor padrÃ£o
            
            if (user) {
                try {
                    const userData = JSON.parse(user);
                    iduser = userData.id || '1';
                } catch (error) {
                    console.log('Usando ID padrÃ£o para usuÃ¡rio');
                }
            }
            
            fetch('/api/empresas', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: `iduser=${iduser}`
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('ğŸ“¥ Resposta da API empresas:', data);
                
                if (data.msg === "Nenhum dado Encontrado") {
                    showAlert('â„¹ï¸ Nenhuma empresa encontrada para este usuÃ¡rio', 'success');
                    localStorage.setItem('empresas', JSON.stringify([]));
                    localStorage.setItem('empresas_timestamp', Date.now().toString());
                } else if (data.msg === "sucesso" && data[0]) {
                    // A API retorna: {"msg":"sucesso","0":{"idempresa":"517798",...},"1":{"idempresa":"...",...}}
                    const empresas = [];
                    Object.keys(data).forEach(key => {
                        if (key !== 'msg' && data[key]) {
                            // Adicionar campo 'realizado' para controle de inspeÃ§Ã£o
                            const empresa = {
                                ...data[key],
                                realizado: false // Por padrÃ£o, inspeÃ§Ã£o nÃ£o foi realizada
                            };
                            empresas.push(empresa);
                        }
                    });
                    
                    localStorage.setItem('empresas', JSON.stringify(empresas));
                    localStorage.setItem('empresas_timestamp', Date.now().toString());
                    showAlert(`âœ… ${empresas.length} empresas baixadas com sucesso!`, 'success');
                } else if (data.empresas || Array.isArray(data)) {
                    const empresas = data.empresas || data;
                    localStorage.setItem('empresas', JSON.stringify(empresas));
                    localStorage.setItem('empresas_timestamp', Date.now().toString());
                    showAlert(`âœ… ${empresas.length} empresas baixadas com sucesso!`, 'success');
                } else {
                    showAlert('âŒ Formato de resposta inesperado da API', 'error');
                    console.log('Resposta inesperada:', data);
                }
            })
            .catch(error => {
                console.error('âŒ Erro ao baixar empresas:', error);
                showAlert(`âŒ Erro ao baixar empresas: ${error.message}`, 'error');
            });
        }

        function sincronizarDados() {
            showAlert('ğŸ”„ Sincronizando dados com o servidor...', 'success');
            
            fetch('/api/sincronizar', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showAlert('âœ… SincronizaÃ§Ã£o concluÃ­da com sucesso!', 'success');
                } else {
                    showAlert('âŒ Erro na sincronizaÃ§Ã£o', 'error');
                }
            })
            .catch(error => {
                console.error('Erro na sincronizaÃ§Ã£o:', error);
                showAlert('âŒ Erro ao sincronizar dados', 'error');
            });
        }

        function listarEmpresas() {
            console.log('ğŸ“‹ Listando empresas do banco local');
            
            // Buscar dados diretamente do localStorage (banco local)
            const empresas = JSON.parse(localStorage.getItem('empresas') || '[]');
            const timestamp = localStorage.getItem('empresas_timestamp');
            
            if (empresas.length === 0) {
                console.log('âŒ Banco local vazio - nenhuma empresa encontrada');
                showAlert('â„¹ï¸ Nenhuma empresa encontrada no banco local. Use "BAIXAR EMPRESAS" primeiro.', 'info');
                return;
            }
            
            // Criar lista formatada para exibiÃ§Ã£o
            let empresasList = 'ğŸ“‹ **LISTA DE EMPRESAS CADASTRADAS**\n\n';
            empresas.forEach((empresa, index) => {
                const status = empresa.status || 'Ativo';
                const cidade = empresa.cidade || 'N/A';
                const realizado = empresa.realizado ? 'âœ… Realizada' : 'â³ Pendente';
                const coordenadas = empresa.latitude && empresa.longitude ? 
                    `ğŸ“ ${empresa.latitude}, ${empresa.longitude}` : 'ğŸ“ Coordenadas nÃ£o definidas';
                
                empresasList += `**${index + 1}. ${empresa.nome}**\n`;
                empresasList += `   ğŸ†” ID: ${empresa.idempresa || 'N/A'}\n`;
                empresasList += `   ğŸ¯ Meta: ${empresa.idmeta || 'N/A'}\n`;
                empresasList += `   ğŸ™ï¸ Cidade: ${cidade}\n`;
                empresasList += `   ğŸ“Š Status: ${status}\n`;
                empresasList += `   ğŸ” InspeÃ§Ã£o: ${realizado}\n`;
                empresasList += `   ${coordenadas}\n\n`;
            });
            
            // Mostrar lista formatada
            showAlert(empresasList, 'success');
            
            // Log detalhado no console
            console.log('ğŸ“Š === DADOS COMPLETOS DO BANCO LOCAL ===');
            console.log('ğŸ•’ Timestamp de download:', timestamp ? new Date(parseInt(timestamp)).toLocaleString() : 'N/A');
            console.log('ğŸ“ˆ Total de empresas:', empresas.length);
            console.log('ğŸ—„ï¸ Dados brutos do localStorage:', empresas);
        }



        function visualizarEmpresasLocais() {
            console.log('ğŸ‘ï¸ Visualizando empresas locais');
            
            // Buscar dados diretamente do localStorage (banco local)
            const empresas = JSON.parse(localStorage.getItem('empresas') || '[]');
            const timestamp = localStorage.getItem('empresas_timestamp');
            
            if (empresas.length === 0) {
                showAlert('â„¹ï¸ Nenhuma empresa encontrada no banco local', 'info');
                return;
            }
            
            const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
            
            let html = `
                <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    <h3>ğŸ¢ Empresas Locais</h3>
                    <p><strong>Baixado em:</strong> ${data}</p>
                    <p><strong>Total de empresas:</strong> ${empresas.length}</p>
                    
                    <div style="margin-top: 20px;">
                        <h4>ğŸ“‹ Lista de Empresas:</h4>
            `;
            
            empresas.forEach((empresa, index) => {
                const status = empresa.status || 'Ativo';
                const cidade = empresa.cidade || 'N/A';
                const realizado = empresa.realizado ? 'âœ… Realizada' : 'â³ Pendente';
                const coordenadas = empresa.latitude && empresa.longitude ? 
                    `ğŸ“ ${empresa.latitude}, ${empresa.longitude}` : 'ğŸ“ Coordenadas nÃ£o definidas';
                
                html += `
                    <div style="background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid #5abaa3;">
                        <h5 style="margin: 0 0 10px 0; color: #26397f;">${index + 1}. ${empresa.nome || empresa.razao || 'Nome nÃ£o informado'}</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 14px;">
                            <div><strong>ğŸ†” ID:</strong> ${empresa.idempresa || 'N/A'}</div>
                            <div><strong>ğŸ¯ Meta:</strong> ${empresa.idmeta || 'N/A'}</div>
                            <div><strong>ğŸ™ï¸ Cidade:</strong> ${cidade}</div>
                            <div><strong>ğŸ“Š Status:</strong> ${status}</div>
                            <div><strong>ğŸ” InspeÃ§Ã£o:</strong> ${realizado}</div>
                            <div><strong>${coordenadas}</strong></div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button onclick="limparConteudo()" style="background: #e9e674; color: #26397f; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                            ğŸ—‘ï¸ Limpar VisualizaÃ§Ã£o
                        </button>
                    </div>
                </div>
            `;
            
            showAlert('ğŸ¢ Exibindo empresas locais', 'success');
            document.getElementById('content').innerHTML = html;
            
            // Log no console para debug
            console.log('âœ… ConteÃºdo inserido na tela:', html);
        }

        function baixarConfigTermo() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/config-termo';
                showAlert('ğŸ“‹ Baixando configuraÃ§Ã£o do termo...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                fetch(endpoint, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const configData = data.config || data.data || data;
                        console.log(`ğŸ’¾ Salvando no localStorage:`, configData);
                        localStorage.setItem('config_termo', JSON.stringify(configData));
                        localStorage.setItem('config_termo_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('config_termo');
                        console.log(`âœ… Dados salvos no localStorage:`, savedData);
                        
                        showAlert('âœ… ConfiguraÃ§Ã£o baixada com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar configuraÃ§Ã£o', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar configuraÃ§Ã£o:', error);
                    showAlert('âŒ Erro ao baixar configuraÃ§Ã£o', 'error');
                    reject();
                });
            });
        }

        function baixarRtsHistorico() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/rts-historico';
                showAlert('ğŸ‘¥ Baixando histÃ³rico de RTS...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const rtsData = data.historico || data.data || data;
                        console.log(`ğŸ’¾ Salvando RTS no localStorage:`, rtsData);
                        localStorage.setItem('rts_historico', JSON.stringify(rtsData));
                        localStorage.setItem('rts_historico_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('rts_historico');
                        console.log(`âœ… RTS salvo no localStorage:`, savedData);
                        
                        showAlert('âœ… HistÃ³rico de RTS baixado com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar histÃ³rico de RTS', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar histÃ³rico de RTS:', error);
                    showAlert('âŒ Erro ao baixar histÃ³rico de RTS', 'error');
                    reject();
                });
            });
        }

        function baixarTiposInspecao() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/tipos-inspecao';
                showAlert('ğŸ” Baixando tipos de inspeÃ§Ã£o...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const tiposData = data.tipos || data.data || data;
                        console.log(`ğŸ’¾ Salvando tipos de inspeÃ§Ã£o no localStorage:`, tiposData);
                        localStorage.setItem('tipos_inspecao', JSON.stringify(tiposData));
                        localStorage.setItem('tipos_inspecao_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('tipos_inspecao');
                        console.log(`âœ… Tipos de inspeÃ§Ã£o salvos no localStorage:`, savedData);
                        
                        showAlert('âœ… Tipos de inspeÃ§Ã£o baixados com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar tipos de inspeÃ§Ã£o', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar tipos de inspeÃ§Ã£o:', error);
                    showAlert('âŒ Erro ao baixar tipos de inspeÃ§Ã£o', 'error');
                    reject();
                });
            });
        }

        function baixarInspecoesHistorico() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/inspecoes-historico';
                showAlert('ğŸ“Š Baixando histÃ³rico de inspeÃ§Ãµes...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const inspecoesData = data.inspecoes || data.data || data;
                        console.log(`ğŸ’¾ Salvando inspeÃ§Ãµes no localStorage:`, inspecoesData);
                        localStorage.setItem('inspecoes_historico', JSON.stringify(inspecoesData));
                        localStorage.setItem('inspecoes_historico_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('inspecoes_historico');
                        console.log(`âœ… InspeÃ§Ãµes salvas no localStorage:`, savedData);
                        
                        showAlert('âœ… HistÃ³rico de inspeÃ§Ãµes baixado com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar histÃ³rico de inspeÃ§Ãµes', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar histÃ³rico de inspeÃ§Ãµes:', error);
                    showAlert('âŒ Erro ao baixar histÃ³rico de inspeÃ§Ãµes', 'error');
                    reject();
                });
            });
        }

        function baixarProtocolos() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/protocolos';
                showAlert('ğŸ“„ Baixando protocolos...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const protocolosData = data.protocolos || data.data || data;
                        console.log(`ğŸ’¾ Salvando protocolos no localStorage:`, protocolosData);
                        localStorage.setItem('protocolos', JSON.stringify(protocolosData));
                        localStorage.setItem('protocolos_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('protocolos');
                        console.log(`âœ… Protocolos salvos no localStorage:`, savedData);
                        
                        showAlert('âœ… Protocolos baixados com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar protocolos', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar protocolos:', error);
                    showAlert('âŒ Erro ao baixar protocolos', 'error');
                    reject();
                });
            });
        }

        function baixarAfastamentos() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/afastamentos';
                showAlert('ğŸ¥ Baixando afastamentos...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const afastamentosData = data.afastamentos || data.data || data;
                        console.log(`ğŸ’¾ Salvando afastamentos no localStorage:`, afastamentosData);
                        localStorage.setItem('afastamentos', JSON.stringify(afastamentosData));
                        localStorage.setItem('afastamentos_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('afastamentos');
                        console.log(`âœ… Afastamentos salvos no localStorage:`, savedData);
                        
                        showAlert('âœ… Afastamentos baixados com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar afastamentos', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar afastamentos:', error);
                    showAlert('âŒ Erro ao baixar afastamentos', 'error');
                    reject();
                });
            });
        }

        function baixarDenuncias() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/denuncias';
                showAlert('ğŸš¨ Baixando denÃºncias...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const denunciasData = data.denuncias || data.data || data;
                        console.log(`ğŸ’¾ Salvando denÃºncias no localStorage:`, denunciasData);
                        localStorage.setItem('denuncias', JSON.stringify(denunciasData));
                        localStorage.setItem('denuncias_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('denuncias');
                        console.log(`âœ… DenÃºncias salvas no localStorage:`, savedData);
                        
                        showAlert('âœ… DenÃºncias baixadas com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar denÃºncias', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar denÃºncias:', error);
                    showAlert('âŒ Erro ao baixar denÃºncias', 'error');
                    reject();
                });
            });
        }

        function baixarOutrosProfissionais() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/outros-profissionais';
                showAlert('ğŸ‘¨â€âš•ï¸ Baixando outros profissionais...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const profissionaisData = data.profissionais || data.data || data;
                        console.log(`ğŸ’¾ Salvando outros profissionais no localStorage:`, profissionaisData);
                        localStorage.setItem('outros_profissionais', JSON.stringify(profissionaisData));
                        localStorage.setItem('outros_profissionais_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('outros_profissionais');
                        console.log(`âœ… Outros profissionais salvos no localStorage:`, savedData);
                        
                        showAlert('âœ… Outros profissionais baixados com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar outros profissionais', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar outros profissionais:', error);
                    showAlert('âŒ Erro ao baixar outros profissionais', 'error');
                    reject();
                });
            });
        }

        function baixarOutrosVinculos() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/outros-vinculos';
                showAlert('ğŸ”— Baixando outros vÃ­nculos...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const vinculosData = data.vinculos || data.data || data;
                        console.log(`ğŸ’¾ Salvando outros vÃ­nculos no localStorage:`, vinculosData);
                        localStorage.setItem('outros_vinculos', JSON.stringify(vinculosData));
                        localStorage.setItem('outros_vinculos_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('outros_vinculos');
                        console.log(`âœ… Outros vÃ­nculos salvos no localStorage:`, savedData);
                        
                        showAlert('âœ… Outros vÃ­nculos baixados com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar outros vÃ­nculos', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar outros vÃ­nculos:', error);
                    showAlert('âŒ Erro ao baixar outros vÃ­nculos', 'error');
                    reject();
                });
            });
        }

        function baixarProcessosEticos() {
            return new Promise((resolve, reject) => {
                const endpoint = '/api/processos-eticos';
                showAlert('âš–ï¸ Baixando processos Ã©ticos...', 'success');
                
                console.log(`ğŸŒ Acessando endpoint: ${endpoint}`);
                
                // Pegar o ID do usuÃ¡rio do localStorage ou usar um valor padrÃ£o
                const user = localStorage.getItem('user');
                let iduser = '1'; // valor padrÃ£o
                
                if (user) {
                    try {
                        const userData = JSON.parse(user);
                        iduser = userData.id || '1';
                    } catch (error) {
                        console.log('Usando ID padrÃ£o para usuÃ¡rio');
                    }
                }

                fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `iduser=${iduser}`
                })
                .then(response => {
                    console.log(`ğŸ“¡ Status da resposta: ${response.status} ${response.statusText}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`ğŸ“¥ Retorno do servidor:`, data);
                    
                    // Verificar se hÃ¡ dados vÃ¡lidos (pode ser data.success, data.msg, ou diretamente data)
                    if (data && (data.success || data.msg === 'sucesso' || data.length > 0 || Object.keys(data).length > 0)) {
                        // Salvar localmente - tentar diferentes estruturas possÃ­veis
                        const processosData = data.processos || data.data || data;
                        console.log(`ğŸ’¾ Salvando processos Ã©ticos no localStorage:`, processosData);
                        localStorage.setItem('processos_eticos', JSON.stringify(processosData));
                        localStorage.setItem('processos_eticos_timestamp', Date.now().toString());
                        
                        // Verificar se foi salvo
                        const savedData = localStorage.getItem('processos_eticos');
                        console.log(`âœ… Processos Ã©ticos salvos no localStorage:`, savedData);
                        
                        showAlert('âœ… Processos Ã©ticos baixados com sucesso!', 'success');
                        resolve();
                    } else {
                        showAlert('âŒ Erro ao baixar processos Ã©ticos', 'error');
                        reject();
                    }
                })
                .catch(error => {
                    console.error('âŒ Erro ao baixar processos Ã©ticos:', error);
                    showAlert('âŒ Erro ao baixar processos Ã©ticos', 'error');
                    reject();
                });
            });
        }

        // FunÃ§Ãµes de VisualizaÃ§Ã£o (dados locais)
        function visualizarConfigTermo() {
            const configData = localStorage.getItem('config_termo');
            
            if (configData) {
                try {
                    const config = JSON.parse(configData);
                    const timestamp = localStorage.getItem('config_termo_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h3>ğŸ“‹ ConfiguraÃ§Ã£o do Termo</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(config)) {
                        html += `<p><strong>Total de campos:</strong> ${config.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem JSON completo
                        if (config.length > 0) {
                            html += `<p><strong>Primeiros campos:</strong></p>`;
                            config.slice(0, 5).forEach((campo, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                if (typeof campo === 'object') {
                                    Object.entries(campo).forEach(([chave, valor]) => {
                                        if (valor && valor !== 'null' && valor !== '') {
                                            html += `<strong>${chave}:</strong> ${valor}<br>`;
                                        }
                                    });
                                } else {
                                    html += `<strong>Campo ${index + 1}:</strong> ${campo}`;
                                }
                                html += `</div>`;
                            });
                            
                            if (config.length > 5) {
                                html += `<p><em>... e mais ${config.length - 5} campos</em></p>`;
                            }
                        }
                    } else if (typeof config === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(config).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${config}</p>`;
                    }
                    
                    html += `
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="limparConteudo()" style="background: #e9e674; color: #26397f; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                                ğŸ—‘ï¸ Limpar VisualizaÃ§Ã£o
                            </button>
                        </div>
                    </div>
                    `;
                    
                    showAlert('ğŸ“‹ Exibindo configuraÃ§Ã£o do termo', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar configuraÃ§Ã£o:', error);
                    showAlert('âŒ Erro ao carregar configuraÃ§Ã£o', 'error');
                }
            } else {
                showAlert('âŒ Nenhuma configuraÃ§Ã£o encontrada. Baixe primeiro!', 'error');
            }
        }

        function visualizarRtsHistorico() {
            const rtsData = localStorage.getItem('rts_historico');
            
            if (rtsData) {
                try {
                    const historico = JSON.parse(rtsData);
                    const timestamp = localStorage.getItem('rts_historico_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h3>ğŸ‘¥ HistÃ³rico de RTS</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(historico)) {
                        html += `<p><strong>Total de registros:</strong> ${historico.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem JSON completo
                        if (historico.length > 0) {
                            html += `<p><strong>Primeiros registros:</strong></p>`;
                            historico.slice(0, 5).forEach((item, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(item).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (historico.length > 5) {
                                html += `<p><em>... e mais ${historico.length - 5} registros</em></p>`;
                            }
                        }
                    } else if (typeof historico === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(historico).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${historico}</p>`;
                    }
                    
                    html += `
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="limparConteudo()" style="background: #e9e674; color: #26397f; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                                ğŸ—‘ï¸ Limpar VisualizaÃ§Ã£o
                            </button>
                        </div>
                    </div>
                    `;
                    
                    showAlert('ğŸ‘¥ Exibindo histÃ³rico de RTS', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar histÃ³rico RTS:', error);
                    showAlert('âŒ Erro ao carregar histÃ³rico RTS', 'error');
                }
            } else {
                showAlert('âŒ Nenhum histÃ³rico RTS encontrado. Baixe primeiro!', 'error');
            }
        }

        function visualizarTiposInspecao() {
            const tiposData = localStorage.getItem('tipos_inspecao');
            
            if (tiposData) {
                try {
                    const tipos = JSON.parse(tiposData);
                    const timestamp = localStorage.getItem('tipos_inspecao_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h3>ğŸ” Tipos de InspeÃ§Ã£o</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(tipos)) {
                        html += `<p><strong>Total de tipos:</strong> ${tipos.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem tabela complexa
                        if (tipos.length > 0) {
                            html += `<p><strong>Tipos disponÃ­veis:</strong></p>`;
                            tipos.slice(0, 5).forEach((tipo, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(tipo).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (tipos.length > 5) {
                                html += `<p><em>... e mais ${tipos.length - 5} tipos</em></p>`;
                            }
                        }
                    } else if (typeof tipos === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(tipos).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${tipos}</p>`;
                    }
                    
                    html += `
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="limparConteudo()" style="background: #e9e674; color: #26397f; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                                ğŸ—‘ï¸ Limpar VisualizaÃ§Ã£o
                            </button>
                        </div>
                    </div>
                    `;
                    
                    showAlert('ğŸ” Exibindo tipos de inspeÃ§Ã£o', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar tipos de inspeÃ§Ã£o:', error);
                    showAlert('âŒ Erro ao carregar tipos de inspeÃ§Ã£o', 'error');
                }
            } else {
                showAlert('âŒ Nenhum tipo de inspeÃ§Ã£o encontrado. Baixe primeiro!', 'error');
            }
        }

        function visualizarInspecoesHistorico() {
            const inspecoesData = localStorage.getItem('inspecoes_historico');
            
            if (inspecoesData) {
                try {
                    const inspecoes = JSON.parse(inspecoesData);
                    const timestamp = localStorage.getItem('inspecoes_historico_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h3>ğŸ“Š HistÃ³rico de InspeÃ§Ãµes</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(inspecoes)) {
                        html += `<p><strong>Total de inspeÃ§Ãµes:</strong> ${inspecoes.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem tabela complexa
                        if (inspecoes.length > 0) {
                            html += `<p><strong>Primeiras inspeÃ§Ãµes:</strong></p>`;
                            inspecoes.slice(0, 5).forEach((inspecao, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(inspecao).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (inspecoes.length > 5) {
                                html += `<p><em>... e mais ${inspecoes.length - 5} inspeÃ§Ãµes</em></p>`;
                            }
                        }
                    } else if (typeof inspecoes === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(inspecoes).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${inspecoes}</p>`;
                    }
                    
                    html += `
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="limparConteudo()" style="background: #e9e674; color: #26397f; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                                ğŸ—‘ï¸ Limpar VisualizaÃ§Ã£o
                            </button>
                        </div>
                    </div>
                    `;
                    
                    showAlert('ğŸ“Š Exibindo histÃ³rico de inspeÃ§Ãµes', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar histÃ³rico de inspeÃ§Ãµes:', error);
                    showAlert('âŒ Erro ao carregar histÃ³rico de inspeÃ§Ãµes', 'error');
                }
            } else {
                showAlert('âŒ Nenhum histÃ³rico de inspeÃ§Ãµes encontrado. Baixe primeiro!', 'error');
            }
        }

        function visualizarProtocolos() {
            const protocolosData = localStorage.getItem('protocolos');
            
            if (protocolosData) {
                try {
                    const protocolos = JSON.parse(protocolosData);
                    const timestamp = localStorage.getItem('protocolos_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h3>ğŸ“„ Protocolos</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(protocolos)) {
                        html += `<p><strong>Total de protocolos:</strong> ${protocolos.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem tabela complexa
                        if (protocolos.length > 0) {
                            html += `<p><strong>Primeiros protocolos:</strong></p>`;
                            protocolos.slice(0, 5).forEach((protocolo, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(protocolo).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (protocolos.length > 5) {
                                html += `<p><em>... e mais ${protocolos.length - 5} protocolos</em></p>`;
                            }
                        }
                    } else if (typeof protocolos === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(protocolos).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${protocolos}</p>`;
                    }
                    
                    html += `
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="limparConteudo()" style="background: #e9e674; color: #26397f; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                                ğŸ—‘ï¸ Limpar VisualizaÃ§Ã£o
                            </button>
                        </div>
                    </div>
                    `;
                    
                    showAlert('ğŸ“„ Exibindo protocolos', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar protocolos:', error);
                    showAlert('âŒ Erro ao carregar protocolos', 'error');
                }
            } else {
                showAlert('âŒ Nenhum protocolo encontrado. Baixe primeiro!', 'error');
            }
        }

        function visualizarAfastamentos() {
            const afastamentosData = localStorage.getItem('afastamentos');
            
            if (afastamentosData) {
                try {
                    const afastamentos = JSON.parse(afastamentosData);
                    const timestamp = localStorage.getItem('afastamentos_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h3>ğŸš« Afastamentos</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(afastamentos)) {
                        html += `<p><strong>Total de afastamentos:</strong> ${afastamentos.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem tabela complexa
                        if (afastamentos.length > 0) {
                            html += `<p><strong>Primeiros afastamentos:</strong></p>`;
                            afastamentos.slice(0, 5).forEach((afastamento, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(afastamento).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (afastamentos.length > 5) {
                                html += `<p><em>... e mais ${afastamentos.length - 5} afastamentos</em></p>`;
                            }
                        }
                    } else if (typeof afastamentos === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(afastamentos).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${afastamentos}</p>`;
                    }
                    
                    html += `
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="limparConteudo()" style="background: #e9e674; color: #26397f; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                                ğŸ—‘ï¸ Limpar VisualizaÃ§Ã£o
                            </button>
                        </div>
                    </div>
                    `;
                    
                    showAlert('ğŸš« Exibindo afastamentos', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar afastamentos:', error);
                    showAlert('âŒ Erro ao carregar afastamentos', 'error');
                }
            } else {
                showAlert('âŒ Nenhum afastamento encontrado. Baixe primeiro!', 'error');
            }
        }

        function visualizarDenuncias() {
            const denunciasData = localStorage.getItem('denuncias');
            
            if (denunciasData) {
                try {
                    const denuncias = JSON.parse(denunciasData);
                    const timestamp = localStorage.getItem('denuncias_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px;">
                            <h3>ğŸš¨ DenÃºncias</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(denuncias)) {
                        html += `<p><strong>Total de denÃºncias:</strong> ${denuncias.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem tabela complexa
                        if (denuncias.length > 0) {
                            html += `<p><strong>Primeiras denÃºncias:</strong></p>`;
                            denuncias.slice(0, 5).forEach((denuncia, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(denuncia).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (denuncias.length > 5) {
                                html += `<p><em>... e mais ${denuncias.length - 5} denÃºncias</em></p>`;
                            }
                        }
                    } else if (typeof denuncias === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(denuncias).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${denuncias}</p>`;
                    }
                    
                    html += `</div>`;
                    
                    showAlert('ğŸš¨ Exibindo denÃºncias', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar denÃºncias:', error);
                    showAlert('âŒ Erro ao carregar denÃºncias', 'error');
                }
            } else {
                showAlert('âŒ Nenhuma denÃºncia encontrada. Baixe primeiro!', 'error');
            }
        }

        function visualizarOutrosProfissionais() {
            const profissionaisData = localStorage.getItem('outros_profissionais');
            
            if (profissionaisData) {
                try {
                    const profissionais = JSON.parse(profissionaisData);
                    const timestamp = localStorage.getItem('outros_profissionais_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px;">
                            <h3>ğŸ‘¨â€âš•ï¸ Outros Profissionais</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(profissionais)) {
                        html += `<p><strong>Total de profissionais:</strong> ${profissionais.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem tabela complexa
                        if (profissionais.length > 0) {
                            html += `<p><strong>Primeiros profissionais:</strong></p>`;
                            profissionais.slice(0, 5).forEach((profissional, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(profissional).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (profissionais.length > 5) {
                                html += `<p><em>... e mais ${profissionais.length - 5} profissionais</em></p>`;
                            }
                        }
                    } else if (typeof profissionais === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(profissionais).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${profissionais}</p>`;
                    }
                    
                    html += `</div>`;
                    
                    showAlert('ğŸ‘¨â€âš•ï¸ Exibindo outros profissionais', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar outros profissionais:', error);
                    showAlert('âŒ Erro ao carregar outros profissionais', 'error');
                }
            } else {
                showAlert('âŒ Nenhum outro profissional encontrado. Baixe primeiro!', 'error');
            }
        }

        function visualizarOutrosVinculos() {
            const vinculosData = localStorage.getItem('outros_vinculos');
            
            if (vinculosData) {
                try {
                    const vinculos = JSON.parse(vinculosData);
                    const timestamp = localStorage.getItem('outros_vinculos_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px;">
                            <h3>ğŸ”— Outros VÃ­nculos</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(vinculos)) {
                        html += `<p><strong>Total de vÃ­nculos:</strong> ${vinculos.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem tabela complexa
                        if (vinculos.length > 0) {
                            html += `<p><strong>Primeiros vÃ­nculos:</strong></p>`;
                            vinculos.slice(0, 5).forEach((vinculo, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(vinculo).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (vinculos.length > 5) {
                                html += `<p><em>... e mais ${vinculos.length - 5} vÃ­nculos</em></p>`;
                            }
                        }
                    } else if (typeof vinculos === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(vinculos).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${vinculos}</p>`;
                    }
                    
                    html += `</div>`;
                    
                    showAlert('ğŸ”— Exibindo outros vÃ­nculos', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar outros vÃ­nculos:', error);
                    showAlert('âŒ Erro ao carregar outros vÃ­nculos', 'error');
                }
            } else {
                showAlert('âŒ Nenhum outro vÃ­nculo encontrado. Baixe primeiro!', 'error');
            }
        }

        function visualizarProcessosEticos() {
            const processosData = localStorage.getItem('processos_eticos');
            
            if (processosData) {
                try {
                    const processos = JSON.parse(processosData);
                    const timestamp = localStorage.getItem('processos_eticos_timestamp');
                    const data = new Date(parseInt(timestamp)).toLocaleString('pt-BR');
                    
                    let html = `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px;">
                            <h3>âš–ï¸ Processos Ã‰ticos</h3>
                            <p><strong>Baixado em:</strong> ${data}</p>
                    `;
                    
                    // Verificar se Ã© um array ou objeto e exibir adequadamente
                    if (Array.isArray(processos)) {
                        html += `<p><strong>Total de processos:</strong> ${processos.length}</p>`;
                        
                        // Mostrar apenas os dados principais, sem tabela complexa
                        if (processos.length > 0) {
                            html += `<p><strong>Primeiros processos:</strong></p>`;
                            processos.slice(0, 5).forEach((processo, index) => {
                                html += `<div style="background: #f8f9fa; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #5abaa3;">`;
                                Object.entries(processo).forEach(([chave, valor]) => {
                                    if (valor && valor !== 'null' && valor !== '') {
                                        html += `<strong>${chave}:</strong> ${valor}<br>`;
                                    }
                                });
                                html += `</div>`;
                            });
                            
                            if (processos.length > 5) {
                                html += `<p><em>... e mais ${processos.length - 5} processos</em></p>`;
                            }
                        }
                    } else if (typeof processos === 'object') {
                        // Para objetos, mostrar campos principais
                        html += `<p><strong>Campos disponÃ­veis:</strong></p>`;
                        Object.entries(processos).forEach(([chave, valor]) => {
                            if (valor && valor !== 'null' && valor !== '') {
                                html += `<div style="background: #f8f9fa; padding: 8px; margin: 3px 0; border-radius: 4px;">`;
                                html += `<strong>${chave}:</strong> ${valor}`;
                                html += `</div>`;
                            }
                        });
                    } else {
                        html += `<p><strong>Valor:</strong> ${processos}</p>`;
                    }
                    
                    html += `</div>`;
                    
                    showAlert('âš–ï¸ Exibindo processos Ã©ticos', 'success');
                    document.getElementById('content').innerHTML = html;
                } catch (error) {
                    console.error('âŒ Erro ao carregar processos Ã©ticos:', error);
                    showAlert('âŒ Erro ao carregar processos Ã©ticos', 'error');
                }
            } else {
                showAlert('âŒ Nenhum processo Ã©tico encontrado. Baixe primeiro!', 'error');
            }
        }

        function loadUserData() {
            const user = localStorage.getItem('user');
            const isAuthenticated = localStorage.getItem('isAuthenticated');

            if (!isAuthenticated || !user) {
                window.location.href = '/';
                return;
            }

            try {
                const userData = JSON.parse(user);
                userNameElement.textContent = userData.name;
                


            } catch (error) {
                console.error('Erro ao carregar dados do usuÃ¡rio:', error);
                logout();
            }
        }

        // Carregar dados quando a pÃ¡gina carregar
        document.addEventListener('DOMContentLoaded', loadUserData);

        // Verificar autenticaÃ§Ã£o a cada 5 minutos
        setInterval(() => {
            const isAuthenticated = localStorage.getItem('isAuthenticated');
            if (!isAuthenticated) {
                logout();
            }
        }, 300000); // 5 minutos
        
        // FunÃ§Ã£o para limpar o conteÃºdo da Ã¡rea de visualizaÃ§Ã£o
        function limparConteudo() {
            document.getElementById('content').innerHTML = '';
            showAlert('ğŸ—‘ï¸ VisualizaÃ§Ã£o limpa', 'success');
        }

    </script>
</body>
</html> 